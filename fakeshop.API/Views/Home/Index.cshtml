@{
    ViewData["Title"] = "Home Page";
}

<div class="container mt-5">
    <h1 class="text-center mb-4">FakeShop E-Commerce</h1>

    <!-- Lista de produtos -->
    <div class="row" id="products-container">
        <!-- Os produtos vão ser inseridos aqui via JS -->
    </div>
</div>

@section Scripts {
    <script>
        document.addEventListener("DOMContentLoaded", function () {

            fetch('/api/products') 
                .then(res => {
                    if (!res.ok) {
                        throw new Error("Erro ao buscar produtos");
                    }
                    return res.json();
                })
                .then(products => {

                    const container = document.getElementById("products-container");
                    container.innerHTML = "";

                    products.forEach(p => {

                        const col = document.createElement("div");
                        col.className = "col-12 col-sm-6 col-md-4 mb-4";

                        col.innerHTML = `
                            <div class="card h-100 shadow-sm">
                                <img src="${p.productImageUrl}" class="card-img-top" alt="${p.name}">
                                <div class="card-body d-flex flex-column">
                                    <h5 class="card-title">${p.name}</h5>

                                    <div class="price-vendor">
                                        <p class="card-text price">$${p.price.toFixed(2)}</p>
                                        <span class="card-vendor">${p.vendor?.name ?? ''}</span>
                                    </div>

                                    <button class="btn btn-primary mt-auto">Add to Cart</button>
                                </div>
                            </div>
                        `;

                        container.appendChild(col);
                    });

                })
                .catch(error => {
                    console.error(error);
                });
        });
    </script>
}